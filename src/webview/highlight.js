function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function RdPrompt(a,b,c){function d(a){a.preventDefault(),a.stopPropagation(),g(j.value),i.close()}var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:"",g=4<arguments.length?arguments[4]:void 0,h=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,i=window.open("","prompt","popup,frame=false,width=300,height=150,left=".concat(a||0,",top=").concat(b||0));i.document.documentElement.innerHTML=" <html><head> <title>".concat(h?"\uD83D\uDDE8":"\uD83D\uDCAC","</title><meta name=\"color-scheme\" content=\"light dark\"> <style> html, body, textarea { box-sizing: border-box; display: block; width: 100vw;height: 100vh; margin: 0;outline: none;border: 0; font: 14px -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji; resize: none; } @supports (-webkit-backdrop-filter: blur(1px)) { textarea { background: Window; } } textarea { padding: 10px; } </style> </head><body><textarea type=\"text\" autoFocus placeholder=\"").concat(c,"\"></textarea></body></html> ");var j=i.document.querySelector("textarea");j.value=f,j.setSelectionRange(0,j.value.length),j.addEventListener("blur",d),j.addEventListener("keydown",a=>{switch(a.code){case"Enter":a.metaKey||a.ctrlKey?a.target.value+="\n":!a.shiftKey&&d(a);break;case"Escape":j.value=f,d(a);}}),i.addEventListener("blur",d)}class RdTooltip{constructor(a,b){var{onColorClick:c,onNoteClick:d,onRemoveClick:e}=b;_defineProperty(this,"_parent",null),_defineProperty(this,"_menu",null),_defineProperty(this,"_listeners",{}),_defineProperty(this,"_hidden",!0),_defineProperty(this,"_colors",["yellow","blue","green","red"]),_defineProperty(this,"_classMenu","rdhm"),_defineProperty(this,"_classButtonColor","rdhbh"),_defineProperty(this,"_classButtonNote","rdhbn"),_defineProperty(this,"_classButtonRemove","rdhbr"),_defineProperty(this,"_idCss","rdhss"),_defineProperty(this,"_attrColor","data-rdhsc"),this._parent=a,this._listeners={onColorClick:c,onNoteClick:d,onRemoveClick:e},this._initStyles(),this._initMenu(),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this._windowMouseDown=this._windowMouseDown.bind(this),this._windowResize=this._windowResize.bind(this),this._parent._window.removeEventListener("mousedown",this._windowMouseDown),this._parent._window.addEventListener("mousedown",this._windowMouseDown),this._parent._window.removeEventListener("resize",this._windowResize),this._parent._window.addEventListener("resize",this._windowResize)}show(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",d=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3],e=!!(4<arguments.length&&void 0!==arguments[4])&&arguments[4],f=a,g=b;if(this._parent._window.outerWidth<=f+80&&(f-=80),this._parent._window.scrollY>g&&(g=this._parent._window.scrollY),this._menu.setAttribute("style","left: ".concat(f,"px !important; top: ").concat(g,"px !important;")),this._menu.querySelectorAll("[".concat(this._attrColor,"]")).forEach(a=>a.removeAttribute("data-active")),c){var j=this._menu.querySelector("[".concat(this._attrColor,"=\"").concat(c.trim(),"\"]"));j&&j.setAttribute("data-active","true")}var h=this._menu.querySelector(".".concat(this._classButtonNote));d?h.setAttribute("data-badge","1"):h.removeAttribute("data-badge");var i=this._menu.querySelector(".".concat(this._classButtonRemove));i.setAttribute("hidden",e?"false":"true"),this._menu.removeAttribute("hidden"),this._hidden=!1}hide(){this._menu&&(this._hidden=!0,this._menu.setAttribute("hidden","true"))}_windowMouseDown(a){this._hidden||a.target==this._menu||this._menu.contains(a.target)||this.hide()}_windowResize(){this._hidden||this.hide()}_colorClick(a){a.preventDefault();"function"!=typeof this._listeners.onColorClick||this._listeners.onColorClick(a.currentTarget.getAttribute(this._attrColor)||"")}_noteClick(a){a.preventDefault();"function"!=typeof this._listeners.onNoteClick||this._listeners.onNoteClick(a.screenX-14,a.screenY-14)}_removeClick(a){a.preventDefault();"function"!=typeof this._listeners.onRemoveClick||this._listeners.onRemoveClick()}_initMenu(){this._menu||(this._menu=this._parent._document.createElement("menu"),this._menu.className=this._classMenu,this._menu.setAttribute("hidden","true"),this._menu.innerHTML=" <li title=\"Highlight\"> ".concat(this._colors.map(a=>" <button class=\"".concat(this._classButtonColor,"\" ").concat(this._attrColor,"=\"").concat(a,"\"></button> ")).join("")," </li> <button class=\"").concat(this._classButtonNote,"\" title=\"Add note...\"> <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\"><path d=\"M15 1a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3v1.9a1 1 0 0 1-1.6.7L10.2 16H4a3 3 0 0 1-3-3V4a3 3 0 0 1 3-3h11Zm0 1H4c-1 0-2 .8-2 1.9V13c0 1 .8 2 1.9 2h6.7l3.4 2.9V15h1c1 0 2-.8 2-1.9V4c0-1-.8-2-1.9-2H15Zm-5 3v3h3v1h-3v3H9V9H6V8h3V5h1Z\"/></svg> </button> <button class=\"").concat(this._classButtonRemove,"\" title=\"Delete\"> <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\"><path d=\"M12 1c.6 0 1 .4 1 1v2h5c.6 0 1 .4 1 1h-2v12c0 1-1 2-2 2H5c-1 0-2-1-2-2V5H1c0-.6.4-1 1-1h5V2c0-.6.4-1 1-1Zm4 4H4v11.8c0 .7.4 1.2 1 1.2h10c.6 0 1-.5 1-1.2V5ZM9 9v5H8V9h1Zm3 0v5h-1V9h1Zm-.5-7h-3c-.3 0-.5.2-.5.5V4h4V2.5c0-.3-.2-.5-.5-.5Z\"/></svg> </button> "),this._parent._container.appendChild(this._menu),this._menu.querySelectorAll(".".concat(this._classButtonColor)).forEach(a=>{this._colorClick=this._colorClick.bind(this),a.removeEventListener("click",this._colorClick),a.addEventListener("click",this._colorClick)}),this._menu.querySelectorAll(".".concat(this._classButtonNote)).forEach(a=>{this._noteClick=this._noteClick.bind(this),a.removeEventListener("click",this._noteClick),a.addEventListener("click",this._noteClick)}),this._menu.querySelectorAll(".".concat(this._classButtonRemove)).forEach(a=>{this._removeClick=this._removeClick.bind(this),a.removeEventListener("click",this._removeClick),a.addEventListener("click",this._removeClick)}))}_initStyles(){if(!this._parent._container.querySelector("#".concat(this._idCss))){var a=this._parent._document.createElement("style");a.id=this._idCss,a.innerHTML=" .".concat(this._classMenu," { position: absolute !important; display: flex !important; z-index: 99999999 !important; background-color: transparent !important; margin: 4px !important; width: auto !important; height: auto !important; left: 0 !important; top: 0 !important; box-shadow: none !important; animation: none !important; transition: opacity .15s ease-in-out !important; will-change: opacity; border: 0 !important; padding: 0 !important; backdrop-filter: blur(20px) !important; -webkit-backdrop-filter: blur(20px) !important; } .").concat(this._classMenu,", .").concat(this._classMenu," *, .").concat(this._classMenu,":after { border-radius: 5px !important; } .").concat(this._classMenu,":after { content: '' !important; position: absolute !important; left: 0 !important; top: 0 !important; right: 0 !important; bottom: 0 !important; z-index: -1 !important; background-color: Menu !important; box-shadow: 0 0 0 0.5px GrayText, 0 5px 30px rgb(0 0 0 / 30%) !important; } @supports (backdrop-filter: blur(20px)) { .").concat(this._classMenu,":after { opacity: .6 !important; } } @supports (-webkit-backdrop-filter: blur(20px)) { .").concat(this._classMenu,":after { opacity: .6 !important; background-color: Window !important; } } .").concat(this._classMenu,", .").concat(this._classMenu," * { box-sizing: border-box !important; user-select: none !important; -webkit-user-select: none !important; } .").concat(this._classMenu,"[hidden='true'] { pointer-events: none !important; opacity: 0 !important; } /* Dropdown */ .").concat(this._classMenu," > li { display: flex !important; flex-direction: column !important; flex-wrap: wrap; !important; max-height: 32px !important; transition: max-height .15s ease-in !important; transition-delay: .1s !important; will-change: max-height; overflow: hidden !important; } .").concat(this._classMenu," > li:hover:not(:active) { max-height: ").concat(32*this._colors.length,"px !important; } /* Buttons */ .").concat(this._classMenu," button { cursor: pointer !important; color: WindowText !important; width: 32px !important; height: 32px !important; appearance: none !important; background: transparent !important; border: 0 !important; box-shadow: none !important; margin: 0 !important; padding: 0 !important; display: flex !important; align-items: center !important; justify-content: center !important; transition: background .1s linear, color .1s linear !important; will-change: background, color; filter: none !important; position: relative !important; } .").concat(this._classMenu," button:hover { background: rgba(100,100,100,.3) !important; } .").concat(this._classMenu," button:active { filter: brightness(50%) !important; } .").concat(this._classMenu," button[hidden='true'] { display: none !important; } .").concat(this._classMenu," button[data-badge]:before { content: attr(data-badge) !important; width: 16px !important; height: 16px !important; border-radius: 14px !important; display: flex !important; align-items: center !important; justify-content: center !important; background: red !important; color: white !important; position: absolute !important; top: -3px !important; right: -3px !important; font-size: 11px !important; line-height: 11px !important; font-weight: 600 !important; box-shadow: inset 0 0 0 .5px rgba(255,255,255,.2), 0 0 0 0.5px rgba(0,0,0,.2), 0 3px 15px rgba(0,0,0,.2) !important; } .").concat(this._classMenu," button[data-active='true'] { order: -1 !important; } .").concat(this._classMenu," * { fill: currentColor !important; } /* Color */ .").concat(this._classMenu," button[").concat(this._attrColor,"]:before { content: '' !important; display: block !important; width: 18px !important; height: 18px !important; border-radius: 18px !important; box-shadow: inset 0 0 0 0.5px rgba(0,0,0,.4) !important; background-image: linear-gradient(to bottom, rgba(255,255,255,.5) 0, rgba(255,255,255,.4) 100%) !important; } ").concat(this._colors.map(a=>" .".concat(this._classMenu," button[").concat(this._attrColor,"=").concat(a,"]:before { background-color: ").concat(a," !important; } ")).join("")," "),this._parent._container.appendChild(a)}}}class RdSelection{constructor(a){_defineProperty(this,"_parent",null),_defineProperty(this,"_tooltip",null),this._parent=a,this._tooltip=new RdTooltip(a,{onColorClick:a=>this._parent.addSelection({color:a}),onNoteClick:(a,b)=>this._parent.noteSelection(a,b)}),this.render=this.render.bind(this),this._onSelectionChange=this._onSelectionChange.bind(this),this._parent._document.removeEventListener("selectionchange",this._onSelectionChange),this._parent._document.addEventListener("selectionchange",this._onSelectionChange),this._parent._window.removeEventListener("focus",this.render),this._parent._window.addEventListener("focus",this.render),this._parent._window.removeEventListener("blur",this.render),this._parent._window.addEventListener("blur",this.render),this._onSelectionChange()}have(){var a=this._parent._window.getSelection();return a&&0<a.rangeCount&&!a.isCollapsed&&0<a.toString().trim().length}render(){if(!this._parent.enabled||!this.have()||!this._parent._document.hasFocus())return void this._tooltip.hide();var a=this._parent._window.getSelection(),{x:b,y:c,width:d}=a.getRangeAt(0).getBoundingClientRect(),e=this._parent._window.scrollX+b+d,f=this._parent._window.scrollY+c-32;this._tooltip.show(e,f)}_onSelectionChange(){clearTimeout(this._selectTimeout),this._selectTimeout=setTimeout(this.render,this.have()?200:0)}}class RdHighlight{constructor(a){_defineProperty(this,"_container",null),_defineProperty(this,"_window",null),_defineProperty(this,"_document",null),_defineProperty(this,"_selection",null),_defineProperty(this,"_tooltip",null),_defineProperty(this,"_activeMarkId",null),_defineProperty(this,"_attrId","data-rdhid"),_defineProperty(this,"_idCss","rdhs"),_defineProperty(this,"_cssColorVar","--rdhc"),_defineProperty(this,"_classNoteIcon","rdhni"),_defineProperty(this,"_classNav","rdhnav"),_defineProperty(this,"enabled",!1),_defineProperty(this,"pro",!1),_defineProperty(this,"nav",!1),_defineProperty(this,"onUpdate",()=>{}),_defineProperty(this,"onRemove",()=>{}),_defineProperty(this,"onAdd",()=>{}),this._container=a,this._document=this._container.ownerDocument,this._window=this._document.defaultView,this._markClick=this._markClick.bind(this),this._markColorClick=this._markColorClick.bind(this),this._markNoteClick=this._markNoteClick.bind(this),this._markRemoveClick=this._markRemoveClick.bind(this),this._navClick=this._navClick.bind(this),this._selection=new RdSelection(this),this._tooltip=new RdTooltip(this,{onColorClick:this._markColorClick,onNoteClick:this._markNoteClick,onRemoveClick:this._markRemoveClick})}apply(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(this.reset(),this._initStyles(),Array.isArray(a))for(var b of a)this.mark(this._getCanditates(this._getTextNodes(this._container),b.text),b)}test(a){var b=this._getTextNodes(this._container),c=this._getCanditates(b,a);return 0<c.size}reset(){this._container.querySelectorAll("mark[".concat(this._attrId,"]")).forEach(a=>a.outerHTML=a.innerText),this._container.querySelectorAll(".".concat(this._classNav)).forEach(a=>a.remove())}scrollToId(a){if(a){var b=this._container.querySelector("mark[".concat(this._attrId,"=\"").concat(a+"","\"]"));b&&b.scrollIntoView({behavior:"smooth",block:"center"})}}addSelection(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};if("function"==typeof this.onAdd){var b=this._window.getSelection();if(b.rangeCount){var c=b.getRangeAt(0).toString().trim();return this.test(c)?void(this.onAdd(_objectSpread(_objectSpread({},a),{},{text:c})),b.removeAllRanges()):void alert("\u26A0\uFE0F Unfortunately we can't add this text")}}}noteSelection(a,b){return this.pro?void RdPrompt(a,b,"Add note...","",a=>{a.trim()&&this.addSelection({note:a})}):alert("Notes/annotations only available in Pro plan")}copySelection(){this._document.execCommand("copy")}mark(a,b){var c=Math.max,{_id:d,color:e,note:f}=b,g=0;for(var[l,m]of a){var h=new Range,j=0,k=l.textContent.length;(0==g||g==a.size-1)&&(j=c(l.textContent.indexOf(m),0),k=j+m.length),h.setStart(l,j),h.setEnd(l,k);var n=this._document.createElement("mark");if(n.setAttribute(this._attrId,d),e&&"yellow"!=e&&n.setAttribute("style","".concat(this._cssColorVar,": ").concat(e)),f&&n.setAttribute("title",f),n.addEventListener("click",this._markClick),n.addEventListener("contextmenu",this._markClick),h.surroundContents(n),g==a.size-1&&f&&n.insertAdjacentHTML("beforeend","<svg class=\"".concat(this._classNoteIcon,"\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10 10\"> <path d=\"M8 0a2 2 0 0 1 2 2v8L6 8H2a2 2 0 0 1-2-2V2C0 .9.9 0 2 0h6Zm0 1H2a1 1 0 0 0-1 .9V6c0 .5.4 1 .9 1h4.3L9 8.4V2c0-.5-.4-1-.9-1H8Z\"/> </svg>")),this.nav&&0==g){var o=this._document.createElement("a");o.className=this._classNav,o.setAttribute(this._attrId,d);var p=h.getBoundingClientRect();o.setAttribute("style"," ".concat(e&&"yellow"!=e?"".concat(this._cssColorVar,": ").concat(e,";"):""," top: ").concat(100/this._document.documentElement.scrollHeight*(this._window.scrollY+p.top-10),"%; ").trim()),o.addEventListener("click",this._navClick),this._container.appendChild(o)}h.detach(),g++}}_markClick(a){if("A"!=a.currentTarget.parentElement.tagName){a.preventDefault(),a.stopPropagation();var b=a.currentTarget,c=b.getAttribute(this._attrId),d=(getComputedStyle(b).getPropertyValue(this._cssColorVar)||"").trim(),e=b.hasAttribute("title");this._activeMarkId=c,this._tooltip.show(a.pageX,a.pageY,d,e,!0)}}_markColorClick(a){this._activeMarkId&&(this.onUpdate({_id:this._activeMarkId,color:a}),this._tooltip.hide())}_markNoteClick(a,b){if(this._activeMarkId){var c=this._container.querySelector("[".concat(this._attrId,"=\"").concat(this._activeMarkId,"\"]")),d=c.getAttribute("title")||"";RdPrompt(a,b,"Note...",d,a=>{this.onUpdate({_id:this._activeMarkId,note:a})}),this._tooltip.hide()}}_markRemoveClick(){if(this._activeMarkId){var a=this._container.querySelector("[".concat(this._attrId,"=\"").concat(this._activeMarkId,"\"]")),b=!a.hasAttribute("title")||confirm("Remove highlight?");b&&(this.onRemove({_id:this._activeMarkId}),this._tooltip.hide())}}_navClick(a){a.preventDefault(),a.stopPropagation();var b=a.currentTarget,c=b.getAttribute(this._attrId);this.scrollToId(c)}_initStyles(){if(!this._container.querySelector("#".concat(this._idCss))){var a=this._document.createElement("style");a.id=this._idCss,a.innerHTML=" mark[".concat(this._attrId,"], .").concat(this._classNav,":before { background: var(").concat(this._cssColorVar,", #ffee00) !important; user-select: none !important; -webkit-user-select: none !important; } mark[").concat(this._attrId,"] { background-image: linear-gradient(to bottom, rgba(255,255,255,.7) 0, rgba(255,255,255,.7) 100%) !important; color: black !important; cursor: pointer !important; } .").concat(this._classNoteIcon," { display: inline !important; margin: 0 !important; padding: 0 !important; border: 0 !important; color: inherit !important; opacity: 0.5 !important; fill: currentColor !important; background: transparent !important; border-radius: 0 !important; margin-left: 0.3em !important; margin-right: 0.3em !important; width: 0.85em !important; height: 0.85em !important; } .").concat(this._classNav," { position: fixed !important; right: 0px !important; padding: 10px !important; padding-right: 6px !important; cursor: pointer !important; } .").concat(this._classNav,":before { content: '' !important; display: block !important; width: 10px !important; height: 10px !important; border-radius: 4px !important; box-shadow: 0 0 0 0.5px ButtonShadow, 0 5px 30px rgb(0 0 0 / 30%) !important; background-image: linear-gradient(to bottom, rgba(255,255,255,.2) 0, rgba(255,255,255,.2) 100%) !important; } .").concat(this._classNav,":hover:before { background-image: linear-gradient(to bottom, rgba(255,255,255,.5) 0, rgba(255,255,255,.5) 100%) !important; } .").concat(this._classNav,":active { filter: brightness(50%) !important; } "),this._container.appendChild(a)}}_getCanditates(a,b){var c=new Map,d=0;for(var e of a){var f=0;d&&e.textContent.includes(b.substring(0,d+1).trim())&&(d=0,c.clear());do{if(!b[d].trim()){f++,d++;continue}var g=b.substring(d-f,d+1);if(e.textContent.includes(g))f++,d++,c.set(e,g);else{!f&&d<b.length&&(d=0,c.clear());break}}while(d<b.length);if(d>=b.length)break}return c}_getTextNodes(a){if(a&&a.childNodes){var b=[];for(var c of a.childNodes)switch(c.nodeType){case 1:c.offsetParent&&!c.hasAttribute(this._attrId)&&b.push(...this._getTextNodes(c));break;case 3:c.textContent.trim()&&b.push(c);}return b}}}var rdh,rdhEmbed={enabled:!1,wait:[],send:()=>{},receive:()=>{}};if("object"==typeof chrome&&chrome.runtime&&chrome.runtime.onMessage||"object"==typeof browser&&browser.runtime&&browser.runtime.onMessage){var _browser=window.browser||window.chrome;rdhEmbed.enabled=!0,rdhEmbed.send=(a,b)=>_browser.runtime.sendMessage(null,{type:a,payload:b});var onMessage=(a,b)=>{var{type:c,payload:d}=a;b.id!=_browser.runtime.id||"string"!=typeof c||"undefined"!=typeof d&&"object"!=typeof d||rdhEmbed.receive(c,d)};_browser.runtime.onMessage.removeListener(onMessage),_browser.runtime.onMessage.addListener(onMessage)}else if("function"==typeof require){rdhEmbed.enabled=!0;var{ipcRenderer}=require("electron");rdhEmbed.send=(a,b)=>ipcRenderer.sendToHost("RDH",{type:a,payload:b});var _onMessage=(a,b)=>rdhEmbed.receive(b.type,b.payload);ipcRenderer.removeListener("RDH",_onMessage),ipcRenderer.on("RDH",_onMessage)}else if(window.self!==window.top){rdhEmbed.enabled=!0,rdhEmbed.send=(a,b)=>window.parent.postMessage({type:a,payload:b},"*");var _onMessage2=a=>{var{data:b,source:c}=a;c!==window.parent||"object"!=typeof b||"string"!=typeof b.type||"undefined"!=typeof b.payload&&"object"!=typeof b.payload||rdhEmbed.receive(b.type,b.payload)};window.removeEventListener("message",_onMessage2),window.addEventListener("message",_onMessage2)}if(rdhEmbed.enabled){function a(){if(window.removeEventListener("load",a),rdh=new RdHighlight(document.body),rdh.onUpdate=a=>rdhEmbed.send("RDH_UPDATE",a),rdh.onRemove=a=>rdhEmbed.send("RDH_REMOVE",a),rdh.onAdd=a=>rdhEmbed.send("RDH_ADD",a),rdhEmbed.wait.length){for(var{type:b,payload:c}of rdhEmbed.wait)rdhEmbed.receive(b,c);rdhEmbed.enabled=[]}rdhEmbed.send("RDH_READY",{url:location.href})}rdhEmbed.receive=(a,b)=>rdh?void("RDH_APPLY"===a?rdh.apply(b):"RDH_CONFIG"===a?("boolean"==typeof b.enabled&&(rdh.enabled=b.enabled),"boolean"==typeof b.pro&&(rdh.pro=b.pro),"boolean"==typeof b.nav&&(rdh.nav=b.nav)):"RDH_SCROLL"===a?rdh.scrollToId(b._id):"RDH_ADD_SELECTION"===a?rdh.addSelection(b):"RDH_NOTE_SELECTION"===a?rdh.noteSelection():void 0):void rdhEmbed.wait.push({type:a,payload:b}),"complete"==document.readyState?a():(window.removeEventListener("load",a),window.addEventListener("load",a))}
